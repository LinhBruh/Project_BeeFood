2025-07-17 14:14:40,319 - INFO - Get access_token
2025-07-17 14:14:40,527 - INFO - Get token ok, begin crawl
2025-07-17 14:14:40,527 - INFO - Begin crawl page 1
2025-07-17 14:14:40,527 - INFO - Get restaurants
2025-07-17 14:14:41,137 - INFO - Get restaurants done
2025-07-17 14:14:41,137 - INFO - Get detail restaurants
2025-07-17 14:14:50,146 - INFO - Get detail done!
2025-07-17 14:14:50,146 - INFO - Begin insert data in database
2025-07-17 14:15:20,384 - ERROR - Error at page 1 : localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68790550bb346340a28a3f1f, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]> - BEGIN RETRIES 1/3
2025-07-17 14:15:20,386 - INFO - Traceback (most recent call last):
  File "/opt/airflow/crawl_data/crawl.py", line 218, in main
    collection.insert_many(detailed_restaurants)
  File "/home/airflow/.local/lib/python3.12/site-packages/pymongo/_csot.py", line 119, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pymongo/synchronous/collection.py", line 975, in insert_many
    blk.execute(write_concern, session, _Op.INSERT)
  File "/home/airflow/.local/lib/python3.12/site-packages/pymongo/synchronous/bulk.py", line 736, in execute
    return self.execute_command(generator, write_concern, session, operation)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pymongo/synchronous/bulk.py", line 593, in execute_command
    _ = client._retryable_write(
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pymongo/synchronous/mongo_client.py", line 1898, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pymongo/synchronous/mongo_client.py", line 1784, in _retry_with_session
    return self._retry_internal(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pymongo/_csot.py", line 119, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pymongo/synchronous/mongo_client.py", line 1830, in _retry_internal
    ).run()
      ^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pymongo/synchronous/mongo_client.py", line 2554, in run
    return self._read() if self._is_read else self._write()
                                              ^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pymongo/synchronous/mongo_client.py", line 2662, in _write
    self._server = self._get_server()
                   ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pymongo/synchronous/mongo_client.py", line 2645, in _get_server
    return self._client._select_server(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pymongo/synchronous/mongo_client.py", line 1649, in _select_server
    server = topology.select_server(
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pymongo/synchronous/topology.py", line 398, in select_server
    server = self._select_server(
             ^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pymongo/synchronous/topology.py", line 376, in _select_server
    servers = self.select_servers(
              ^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pymongo/synchronous/topology.py", line 283, in select_servers
    server_descriptions = self._select_servers_loop(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pymongo/synchronous/topology.py", line 333, in _select_servers_loop
    raise ServerSelectionTimeoutError(
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68790550bb346340a28a3f1f, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>

2025-07-17 14:15:32,377 - INFO - Get access_token
2025-07-17 14:15:32,649 - INFO - Get token ok, begin crawl
2025-07-17 14:15:32,649 - INFO - Begin crawl page 1
2025-07-17 14:15:32,649 - INFO - Get restaurants
2025-07-17 14:15:33,098 - INFO - Get restaurants done
2025-07-17 14:15:33,098 - INFO - Get detail restaurants
2025-07-17 14:15:55,092 - INFO - Get detail done!
2025-07-17 14:15:55,093 - INFO - Begin insert data in database
2025-07-17 14:15:55,334 - INFO - Insert done!
2025-07-17 14:15:55,334 - INFO - Begin crawl page 2
2025-07-17 14:15:55,334 - INFO - Get restaurants
2025-07-17 14:15:55,530 - INFO - Get restaurants done
2025-07-17 14:15:55,530 - INFO - Crawl end!
2025-07-17 14:15:55,530 - INFO - Begin crawl page 3
2025-07-17 14:15:55,530 - INFO - Get restaurants
2025-07-17 14:15:55,753 - INFO - Get restaurants done
2025-07-17 14:15:55,754 - INFO - Crawl end!
2025-07-17 14:15:55,754 - INFO - Begin crawl page 4
2025-07-17 14:15:55,754 - INFO - Get restaurants
2025-07-17 14:15:55,970 - INFO - Get restaurants done
2025-07-17 14:15:55,970 - INFO - Crawl end!
2025-07-17 14:15:55,970 - INFO - Begin crawl page 5
2025-07-17 14:15:55,970 - INFO - Get restaurants
2025-07-17 14:15:56,549 - INFO - Get restaurants done
2025-07-17 14:15:56,550 - INFO - Crawl end!
2025-07-17 14:15:56,550 - INFO - Begin crawl page 6
2025-07-17 14:15:56,550 - INFO - Get restaurants
2025-07-17 14:15:56,706 - INFO - Get restaurants done
2025-07-17 14:15:56,706 - INFO - Crawl end!
2025-07-17 14:15:56,706 - INFO - Begin crawl page 7
2025-07-17 14:15:56,706 - INFO - Get restaurants
2025-07-17 14:15:57,237 - INFO - Get restaurants done
2025-07-17 14:15:57,237 - INFO - Crawl end!
2025-07-17 14:15:57,237 - INFO - Begin crawl page 8
2025-07-17 14:15:57,238 - INFO - Get restaurants
2025-07-17 14:15:57,334 - INFO - Get restaurants done
2025-07-17 14:15:57,334 - INFO - Crawl end!
2025-07-17 14:15:57,334 - INFO - Begin crawl page 9
2025-07-17 14:15:57,334 - INFO - Get restaurants
2025-07-17 14:15:57,511 - INFO - Get restaurants done
2025-07-17 14:15:57,511 - INFO - Crawl end!
2025-07-17 14:15:57,511 - INFO - Begin crawl page 10
2025-07-17 14:15:57,511 - INFO - Get restaurants
2025-07-17 14:15:57,795 - INFO - Get restaurants done
2025-07-17 14:15:57,796 - INFO - Crawl end!
2025-07-17 14:16:41,991 - INFO - Get access_token
2025-07-17 14:16:42,242 - INFO - Get token ok, begin crawl
2025-07-17 14:16:42,242 - INFO - Begin crawl page 1
2025-07-17 14:16:42,242 - INFO - Get restaurants
2025-07-17 14:16:42,436 - INFO - Get restaurants done
2025-07-17 14:16:42,436 - INFO - Get detail restaurants
2025-07-17 14:16:43,936 - INFO - Get detail done!
2025-07-17 14:16:43,936 - INFO - Begin insert data in database
2025-07-17 14:16:44,174 - INFO - Insert done!
2025-07-17 14:16:44,174 - INFO - Begin crawl page 2
2025-07-17 14:16:44,174 - INFO - Get restaurants
2025-07-17 14:16:44,371 - INFO - Get restaurants done
2025-07-17 14:16:44,371 - INFO - Crawl end!
2025-07-17 14:16:44,371 - INFO - Begin crawl page 3
2025-07-17 14:16:44,371 - INFO - Get restaurants
2025-07-17 14:16:44,590 - INFO - Get restaurants done
2025-07-17 14:16:44,590 - INFO - Crawl end!
2025-07-17 14:16:44,590 - INFO - Begin crawl page 4
2025-07-17 14:16:44,590 - INFO - Get restaurants
2025-07-17 14:16:44,692 - INFO - Get restaurants done
2025-07-17 14:16:44,692 - INFO - Crawl end!
2025-07-17 14:16:44,692 - INFO - Begin crawl page 5
2025-07-17 14:16:44,692 - INFO - Get restaurants
2025-07-17 14:16:44,812 - INFO - Get restaurants done
2025-07-17 14:16:44,812 - INFO - Crawl end!
2025-07-17 14:16:44,812 - INFO - Begin crawl page 6
2025-07-17 14:16:44,812 - INFO - Get restaurants
2025-07-17 14:16:45,031 - INFO - Get restaurants done
2025-07-17 14:16:45,031 - INFO - Crawl end!
2025-07-17 14:16:45,031 - INFO - Begin crawl page 7
2025-07-17 14:16:45,031 - INFO - Get restaurants
2025-07-17 14:16:45,134 - INFO - Get restaurants done
2025-07-17 14:16:45,135 - INFO - Crawl end!
2025-07-17 14:16:45,135 - INFO - Begin crawl page 8
2025-07-17 14:16:45,135 - INFO - Get restaurants
2025-07-17 14:16:45,251 - INFO - Get restaurants done
2025-07-17 14:16:45,251 - INFO - Crawl end!
2025-07-17 14:16:45,251 - INFO - Begin crawl page 9
2025-07-17 14:16:45,251 - INFO - Get restaurants
2025-07-17 14:16:45,472 - INFO - Get restaurants done
2025-07-17 14:16:45,472 - INFO - Crawl end!
2025-07-17 14:16:45,472 - INFO - Begin crawl page 10
2025-07-17 14:16:45,472 - INFO - Get restaurants
2025-07-17 14:16:46,420 - INFO - Get restaurants done
2025-07-17 14:16:46,421 - INFO - Crawl end!
2025-07-17 14:17:55,513 - INFO - Get access_token
2025-07-17 14:17:55,703 - INFO - Get token ok, begin crawl
2025-07-17 14:17:55,703 - INFO - Begin crawl page 1
2025-07-17 14:17:55,703 - INFO - Get restaurants
2025-07-17 14:17:55,915 - INFO - Get restaurants done
2025-07-17 14:17:55,915 - INFO - Get detail restaurants
2025-07-17 14:17:58,533 - INFO - Get detail done!
2025-07-17 14:17:58,533 - INFO - Begin insert data in database
2025-07-17 14:17:58,760 - INFO - Insert done!
2025-07-17 14:17:58,760 - INFO - Begin crawl page 2
2025-07-17 14:17:58,760 - INFO - Get restaurants
2025-07-17 14:17:58,955 - INFO - Get restaurants done
2025-07-17 14:17:58,955 - INFO - Crawl end!
2025-07-17 14:17:58,955 - INFO - Begin crawl page 3
2025-07-17 14:17:58,955 - INFO - Get restaurants
2025-07-17 14:17:59,058 - INFO - Get restaurants done
2025-07-17 14:17:59,058 - INFO - Crawl end!
2025-07-17 14:17:59,058 - INFO - Begin crawl page 4
2025-07-17 14:17:59,058 - INFO - Get restaurants
2025-07-17 14:17:59,173 - INFO - Get restaurants done
2025-07-17 14:17:59,173 - INFO - Crawl end!
2025-07-17 14:17:59,173 - INFO - Begin crawl page 5
2025-07-17 14:17:59,173 - INFO - Get restaurants
2025-07-17 14:17:59,392 - INFO - Get restaurants done
2025-07-17 14:17:59,392 - INFO - Crawl end!
2025-07-17 14:17:59,392 - INFO - Begin crawl page 6
2025-07-17 14:17:59,393 - INFO - Get restaurants
2025-07-17 14:22:39,946 - INFO - Get access_token
2025-07-17 14:22:40,119 - INFO - Get token ok, begin crawl
2025-07-17 14:22:40,120 - INFO - Begin crawl page 1
2025-07-17 14:22:40,120 - INFO - Get restaurants
2025-07-17 14:22:40,346 - INFO - Get restaurants done
2025-07-17 14:22:40,346 - INFO - Get detail restaurants
2025-07-17 14:22:43,743 - INFO - Get detail done!
2025-07-17 14:22:43,743 - INFO - Begin insert data in database
2025-07-17 14:22:43,973 - INFO - Insert done!
2025-07-17 14:22:43,973 - INFO - Begin crawl page 2
2025-07-17 14:22:43,973 - INFO - Get restaurants
2025-07-17 14:22:44,175 - INFO - Get restaurants done
2025-07-17 14:22:44,175 - INFO - Crawl end!
2025-07-17 14:22:44,175 - INFO - Begin crawl page 3
2025-07-17 14:22:44,176 - INFO - Get restaurants
2025-07-17 14:22:44,301 - INFO - Get restaurants done
2025-07-17 14:22:44,301 - INFO - Crawl end!
2025-07-17 14:22:44,301 - INFO - Begin crawl page 4
2025-07-17 14:22:44,301 - INFO - Get restaurants
2025-07-17 14:22:44,499 - INFO - Get restaurants done
2025-07-17 14:22:44,499 - INFO - Crawl end!
2025-07-17 14:22:44,499 - INFO - Begin crawl page 5
2025-07-17 14:22:44,499 - INFO - Get restaurants
2025-07-17 14:22:44,618 - INFO - Get restaurants done
2025-07-17 14:22:44,619 - INFO - Crawl end!
2025-07-17 14:22:44,619 - INFO - Begin crawl page 6
2025-07-17 14:22:44,619 - INFO - Get restaurants
2025-07-17 14:22:45,031 - INFO - Get restaurants done
2025-07-17 14:22:45,032 - INFO - Crawl end!
2025-07-17 14:22:45,032 - INFO - Begin crawl page 7
2025-07-17 14:22:45,032 - INFO - Get restaurants
2025-07-17 14:22:45,180 - INFO - Get restaurants done
2025-07-17 14:22:45,180 - INFO - Crawl end!
2025-07-17 14:22:45,180 - INFO - Begin crawl page 8
2025-07-17 14:22:45,180 - INFO - Get restaurants
2025-07-17 14:22:45,400 - INFO - Get restaurants done
2025-07-17 14:22:45,400 - INFO - Crawl end!
2025-07-17 14:22:45,400 - INFO - Begin crawl page 9
2025-07-17 14:22:45,400 - INFO - Get restaurants
2025-07-17 14:22:45,503 - INFO - Get restaurants done
2025-07-17 14:22:45,503 - INFO - Crawl end!
2025-07-17 14:22:45,503 - INFO - Begin crawl page 10
2025-07-17 14:22:45,503 - INFO - Get restaurants
2025-07-17 14:22:45,627 - INFO - Get restaurants done
2025-07-17 14:22:45,627 - INFO - Crawl end!
2025-07-17 14:23:12,076 - INFO - Get access_token
2025-07-17 14:23:12,299 - INFO - Get token ok, begin crawl
2025-07-17 14:23:12,299 - INFO - Begin crawl page 1
2025-07-17 14:23:12,299 - INFO - Get restaurants
2025-07-17 14:23:12,466 - INFO - Get restaurants done
2025-07-17 14:23:12,466 - INFO - Get detail restaurants
2025-07-17 14:23:14,001 - INFO - Get detail done!
2025-07-17 14:23:14,001 - INFO - Begin insert data in database
2025-07-17 14:23:14,214 - INFO - Insert done!
2025-07-17 14:23:14,214 - INFO - Begin crawl page 2
2025-07-17 14:23:14,214 - INFO - Get restaurants
2025-07-17 14:23:14,321 - INFO - Get restaurants done
2025-07-17 14:23:14,321 - INFO - Crawl end!
2025-07-17 14:23:14,321 - INFO - Begin crawl page 3
2025-07-17 14:23:14,321 - INFO - Get restaurants
2025-07-17 14:23:14,440 - INFO - Get restaurants done
2025-07-17 14:23:14,440 - INFO - Crawl end!
2025-07-17 14:23:14,440 - INFO - Begin crawl page 4
2025-07-17 14:23:14,440 - INFO - Get restaurants
2025-07-17 14:23:14,661 - INFO - Get restaurants done
2025-07-17 14:23:14,661 - INFO - Crawl end!
2025-07-17 14:23:14,662 - INFO - Begin crawl page 5
2025-07-17 14:23:14,662 - INFO - Get restaurants
2025-07-17 14:23:14,844 - INFO - Get restaurants done
2025-07-17 14:23:14,844 - INFO - Crawl end!
2025-07-17 14:23:14,844 - INFO - Begin crawl page 6
2025-07-17 14:23:14,844 - INFO - Get restaurants
2025-07-17 14:23:14,946 - INFO - Get restaurants done
2025-07-17 14:23:14,946 - INFO - Crawl end!
2025-07-17 14:23:14,946 - INFO - Begin crawl page 7
2025-07-17 14:23:14,946 - INFO - Get restaurants
2025-07-17 14:23:15,090 - INFO - Get restaurants done
2025-07-17 14:23:15,090 - INFO - Crawl end!
2025-07-17 14:23:15,090 - INFO - Begin crawl page 8
2025-07-17 14:23:15,090 - INFO - Get restaurants
2025-07-17 14:23:15,321 - INFO - Get restaurants done
2025-07-17 14:23:15,322 - INFO - Crawl end!
2025-07-17 14:23:15,322 - INFO - Begin crawl page 9
2025-07-17 14:23:15,322 - INFO - Get restaurants
2025-07-17 14:23:15,980 - INFO - Get restaurants done
2025-07-17 14:23:15,980 - INFO - Crawl end!
2025-07-17 14:23:15,980 - INFO - Begin crawl page 10
2025-07-17 14:23:15,980 - INFO - Get restaurants
2025-07-17 14:23:16,084 - INFO - Get restaurants done
2025-07-17 14:23:16,084 - INFO - Crawl end!
2025-07-17 14:33:40,414 - INFO - Get access_token
2025-07-17 14:33:40,656 - INFO - Get token ok, begin crawl
2025-07-17 14:33:40,656 - INFO - Begin crawl page 1
2025-07-17 14:33:40,656 - INFO - Get restaurants
2025-07-17 14:33:40,865 - INFO - Get restaurants done
2025-07-17 14:33:40,865 - INFO - Get detail restaurants
2025-07-17 14:33:44,086 - INFO - Get detail done!
2025-07-17 14:33:44,086 - INFO - Begin insert data in database
2025-07-17 14:33:44,316 - INFO - Insert done!
2025-07-17 14:33:44,317 - INFO - Begin crawl page 2
2025-07-17 14:33:44,317 - INFO - Get restaurants
2025-07-17 14:33:44,739 - INFO - Get restaurants done
2025-07-17 14:33:44,740 - INFO - Crawl end!
2025-07-17 14:33:44,740 - INFO - Begin crawl page 3
2025-07-17 14:33:44,740 - INFO - Get restaurants
2025-07-17 14:33:45,364 - INFO - Get restaurants done
2025-07-17 14:33:45,365 - INFO - Crawl end!
2025-07-17 14:33:45,365 - INFO - Begin crawl page 4
2025-07-17 14:33:45,365 - INFO - Get restaurants
2025-07-17 14:33:45,493 - INFO - Get restaurants done
2025-07-17 14:33:45,493 - INFO - Crawl end!
2025-07-17 14:33:45,493 - INFO - Begin crawl page 5
2025-07-17 14:33:45,493 - INFO - Get restaurants
2025-07-17 14:33:45,627 - INFO - Get restaurants done
2025-07-17 14:33:45,627 - INFO - Crawl end!
2025-07-17 14:33:45,627 - INFO - Begin crawl page 6
2025-07-17 14:33:45,627 - INFO - Get restaurants
2025-07-17 14:33:45,723 - INFO - Get restaurants done
2025-07-17 14:33:45,723 - INFO - Crawl end!
2025-07-17 14:33:45,723 - INFO - Begin crawl page 7
2025-07-17 14:33:45,723 - INFO - Get restaurants
2025-07-17 14:33:45,895 - INFO - Get restaurants done
2025-07-17 14:33:45,895 - INFO - Crawl end!
2025-07-17 14:33:45,895 - INFO - Begin crawl page 8
2025-07-17 14:33:45,895 - INFO - Get restaurants
2025-07-17 14:33:46,059 - INFO - Get restaurants done
2025-07-17 14:33:46,059 - INFO - Crawl end!
2025-07-17 14:33:46,059 - INFO - Begin crawl page 9
2025-07-17 14:33:46,059 - INFO - Get restaurants
2025-07-17 14:33:46,150 - INFO - Get restaurants done
2025-07-17 14:33:46,150 - INFO - Crawl end!
2025-07-17 14:33:46,150 - INFO - Begin crawl page 10
2025-07-17 14:33:46,150 - INFO - Get restaurants
2025-07-17 14:33:46,532 - INFO - Get restaurants done
2025-07-17 14:33:46,532 - INFO - Crawl end!
